"use strict";$(".icon2").on("click",function(e){$("input#search").val("");$("label").removeClass("noactive");$("#searchKey").empty();$("#wrapper").removeClass("noactive");$("#searchLog").removeClass("noactive");$("#searchResult").addClass("noactive")});$("#hot-search").on("click","li",function(e){reset();var value=$(e.currentTarget).text();$("input#search").val(value);timer=null;if(timer){window.clearTimeout(timer)}timer=setTimeout(function(){timer=null;search();$("#searchResult").removeClass("noactive");$("#searchLog").addClass("noactive");$("#wrapper").addClass("noactive");$("#searchKey").empty();var $li=$(e.currentTarget);var value=$li.text();console.log(value);var li='<li>搜索"'+value+'"<li/>';$("#searchKey").append(li)},400)});$("#searchLog").on("click","#icon4",function(e){var $icon4=$(e.currentTarget);var $div=$icon4.parent();$div.remove()});function search(){reset();var value=$("input#search").val().trim();var $searchResult=$("ul#searchResult");var $searchLog=$("ul#searchLog");if(value===""){$("label").removeClass("noactive");return}var query=new AV.Query("Song");query.contains("name",value);query.find().then(function(results){console.log(1);$searchResult.empty();if(results.length===0){}else{for(var i=0;i<results.length;i++){var song=results[i].attributes;var div='\n                                <div>\n                                    <svg class="icon">\n                                        <use xlink:href="#icon-search"></use>\n                                    </svg>\n                                    <a href="./song.html?id='+results[i].id+'"><li data-id="'+results[i].id+'">'+song.name+" - "+song.singer+"</li></a>\n                                </div>\n                             ";$searchResult.append(div)}}});query.find().then(function(results){if(results.length===0){}else{for(var i=0;i<results.length;i++){var song=results[i].attributes;var div='\n                                <div id="div">\n                                    <svg class="icon icon3">\n                                        <use xlink:href="#icon-shizhong"></use>\n                                    </svg>\n                                    <a href="./song.html?id='+results[i].id+'"><li data-id="'+results[i].id+'">'+song.name+" - "+song.singer+'</li></a>\n                                    <svg id="icon4" class="icon icon4">\n                                        <use xlink:href="#icon-quxiao1"></use>\n                                    </svg>\n                                </div>\n\n                             ';$searchLog.prepend(div)}}})}function reset(){$("label").addClass("noactive");$(".icon2").addClass("active")}"use strict";!function($,AV){loadSongs();function loadSongs(){getSongs().then(fillSongs,function(error){alert("获取歌曲失败")})}function template(song,results){return'<li>\n            <a href="./song.html?id='+results.id+'">\n              <div class="wrapper">\n                <h3>'+song.name+'</h3>\n                <svg class="icon " >\n                  <use xlink:href="#icon-SQ"></use>\n                </svg>\n                <p>'+song.singer+'</p>\n              </div>\n              <svg class="icon " >\n                <use xlink:href="#icon-bofangjian60px"></use>\n              </svg>\n            </a>\n          </li>'}function getSongs(){var query=new AV.Query("Song");return query.find()}function fillSongs(results){$("#songs-loading").remove();for(var i=0;i<results.length;i++){var song=results[i].attributes;var li=template(song,results[i]);$("ul#song").append(li)}}}(jQuery,AV);"use strict";!function($,window,AV){var timer=null;$("input#search").on("input",function(){reset();throttle(searchDisplayResult,400)});function reset(){$("label").addClass("noactive");$(".icon2").addClass("active")}function throttle(callback,time){if(timer){window.clearTimeout(timer)}timer=setTimeout(function(){timer=null;callback()},time)}function searchDisplayResult(){search();displayResult()}function template1(result){var song=result.attributes;return'\n            <div>\n                <svg class="icon">\n                    <use xlink:href="#icon-search"></use>\n                </svg>\n                <a href="./song.html?id='+result.id+'"><li data-id="'+result.id+'">'+song.name+" - "+song.singer+"</li></a>\n            </div>\n         "}function template2(result){var song=result.attributes;return'\n            <div id="div">\n                <svg class="icon icon3">\n                    <use xlink:href="#icon-shizhong"></use>\n                </svg>\n                <a href="./song.html?id='+results[i].id+'"><li data-id="'+results[i].id+'">'+song.name+" - "+song.singer+'</li></a>\n                <svg id="icon4" class="icon icon4">\n                    <use xlink:href="#icon-quxiao1"></use>\n                </svg>\n            </div>\n         '}function searchSongs(value){var query1=new AV.Query("Song");query1.contains("name",value);var query2=new AV.Query("Song");query2.contains("singer",value);var query=AV.Query.or(query1,query2);return query.find()}function generateSearchResult1(results){$("ul#searchResult").empty();if(results.length===0){$("ul#searchResult").html("结果不存在")}else{for(var _i=0;_i<results.length;_i++){var div=template1(results[_i]);$("ul#searchResult").append(div)}}}function generateSearchResult2(results){if(results.length===0){$("ul#searchResult").html("结果不存在")}else{for(var _i2=0;_i2<results.length;_i2++){var div=template2(results[_i2]);$("ul#searchLog").prepend(div)}}}function search(){var value=$("input#search").val().trim();if(value===""){$("label").removeClass("noactive");return}searchSongs(value).then(generateSearchResult1);searchSongs(value).then(generateSearchResult2)}function displayResult(){$("#searchLog").addClass("noactive");$("#wrapper").addClass("noactive");$("#searchKey").empty();var value=$("input#search").val();var li='<li>搜索"'+value+'"<li/>';$("#searchKey").append(li)}}(jQuery,window,AV);"use strict";!function($,app){function tabs(selectorOrDom){var $tabs=$(selectorOrDom);$tabs.on("click","li",function(e){var $li=$(e.currentTarget);var index=$li.index();$li.addClass("active").siblings(".active").removeClass("active");var $page=$li.parent().parent().parent().next().children().eq(index);$page.addClass("active").siblings(".active").removeClass("active")})}app.tabs=tabs}(jQuery,app);
