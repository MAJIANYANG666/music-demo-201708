"use strict";define(["jquery","av"],function(n,e){function i(){n("label").addClass("noactive"),n(".icon2").addClass("active")}function a(n,e){d&&window.clearTimeout(d),d=setTimeout(function(){d=null,n()},e)}function s(){l(),v()}function r(n){var e=n.attributes;return'\n            <div>\n                <svg class="icon">\n                    <use xlink:href="#icon-search"></use>\n                </svg>\n                <a href="./song.html?id='+n.id+'"><li data-id="'+n.id+'">'+e.name+" - "+e.singer+"</li></a>\n            </div>\n         "}function t(n){var e=n.attributes;return'<div id="div">\n                <svg class="icon icon3">\n                    <use xlink:href="#icon-shizhong"></use>\n                </svg>\n                <a href="./song.html?id='+n.id+'"><li data-id="'+n.id+'">'+e.name+" - "+e.singer+'</li></a>\n                <svg id="icon4" class="icon icon4">\n                    <use xlink:href="#icon-quxiao1"></use>\n                </svg>\n            </div>'}function u(n){var i=new e.Query("Song");i.contains("name",n);var a=new e.Query("Song");return a.contains("singer",n),e.Query.or(i,a).find()}function o(e){if(n("ul#searchResult").empty(),n("#searchResult").removeClass("noactive"),0===e.length){n("ul#searchNoresult").empty();n("ul#searchNoresult").append("<div>结果不存在</div>")}else{n("ul#searchNoresult").empty();for(var i=0;i<e.length;i++){var a=r(e[i]);n("ul#searchResult").append(a)}}}function c(e){if(0!==e.length)for(var i=0;i<e.length;i++){var a=t(e[i]);n("ul#searchLog").prepend(a)}}function l(){var e=n("input#search").val().trim();if(""===e)return n("#searchNoresult").empty(),void n("label").removeClass("noactive");u(e).then(o),u(e).then(c)}function v(){n("#searchLog").addClass("noactive"),n("#wrapper").addClass("noactive"),n("#searchKey").empty();var e='<li>搜索"'+n("input#search").val()+'"<li/>';n("#searchKey").append(e)}var d=null;return function(){n("input#search").on("input",function(){i(),a(s,400)})}});